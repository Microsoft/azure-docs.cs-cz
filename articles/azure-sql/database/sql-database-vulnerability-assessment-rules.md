---
title: Referenční příručka pravidla posouzení ohrožení zabezpečení SQL
description: Seznam názvů pravidel a popisů SQL Server, Azure SQL Database, spravované instance Azure SQL a Azure synapse Analytics
services: sql-database
ms.service: sql-db-mi
ms.subservice: security
ms.topic: reference
author: davidtrigano
ms.author: datrigan
ms.reviewer: vanto
ms.date: 03/17/2021
ms.openlocfilehash: fc5558f9f75ada78d1d4946c0e7b61ad8618629f
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/30/2021
ms.locfileid: "104597687"
---
# <a name="sql-vulnerability-assessment-rules-reference-guide"></a>Referenční příručka pravidla posouzení ohrožení zabezpečení SQL
[!INCLUDE[appliesto-sqldb-sqlmi-asa](../includes/appliesto-sqldb-sqlmi-asa.md)]

V tomto článku jsou uvedené sady předdefinovaných pravidel, která se používají k označení chyb zabezpečení a zvýrazňování odchylek od osvědčených postupů, jako jsou například chyby konfigurace, nadměrné oprávnění a nechráněná citlivá data. Tato pravidla jsou založená na osvědčených postupech Microsoftu a zaměřuje se na problémy zabezpečení, které představují největší rizika pro vaši databázi a jejich cenná data. Zahrnují jak problémy na úrovni databáze, tak i problémy zabezpečení na úrovni serveru, jako je nastavení brány firewall serveru a oprávnění na úrovni serveru. Tato pravidla také reprezentují mnohé z požadavků různých regulativních orgánů pro splnění standardů dodržování předpisů.

Pravidla zobrazená v databázi závisí na verzi SQL a na kontrolované platformě. 

Další informace o implementaci posouzení ohrožení zabezpečení v Azure najdete v tématu [implementace posouzení ohrožení zabezpečení](./sql-vulnerability-assessment.md#configure-vulnerability-assessment).

Seznam změn těchto pravidel najdete v tématu [pravidla posouzení ohrožení zabezpečení SQL protokolu změn](sql-database-vulnerability-assessment-rules-changelog.md).

## <a name="rule-categories"></a>Kategorie pravidel

Pravidla posouzení ohrožení zabezpečení SQL mají pět kategorií, které jsou v následujících oddílech:

- [Ověřování a autorizace](#authentication-and-authorization)
- [Auditování a protokolování](#auditing-and-logging)
- [Ochrana dat](#data-protection)
- [Aktualizace a opravy instalace](#installation-updates-and-patches)
- [Snížení oblasti povrchu](#surface-area-reduction)

<sup>1</sup> **SQL Server 2012 +** odkazuje na všechny verze SQL Server 2012 a vyšší.

<sup>2</sup> **SQL Server 2017 +** odkazuje na všechny verze SQL Server 2017 a vyšší.

<sup>3</sup> **SQL Server 2016 +** odkazuje na všechny verze SQL Server 2016 a vyšší.

## <a name="authentication-and-authorization"></a>Ověřování a autorizace

|ID pravidla  |Název pravidla   |Závažnost pravidla  |Popis pravidla  |Platforma  |
|---------|---------|---------|---------|---------|
| VA1017     |Oprávnění ke spouštění pro xp_cmdshell všem uživatelům (s výjimkou dbo) by měla být odvolána.          |Vysoká         |Xp_cmdshell Rozšířená uložená procedura vytvoří příkazové prostředí systému Windows a předá řetězec pro provedení. Toto pravidlo kontroluje, že žádní uživatelé (kromě uživatelů s oprávněním ŘÍDICÍho serveru, jako jsou členové role serveru sysadmin) mají oprávnění ke spuštění xp_cmdshell rozšířené uložené procedury.         |<nobr>SQL Server 2012 +<sup>1</sup><nobr/>         |
|VA1020     |Uživatel databáze Host by neměl být členem žádné role.          |Vysoká         |Uživatel typu Host umožňuje přístup k databázi pro všechna přihlášení, která nejsou namapovaná na konkrétního uživatele databáze. Toto pravidlo zkontroluje, zda nejsou k uživateli typu Host přiřazena žádná role databáze.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL Database                  |
|VA1042     |Řetězení vlastnictví databáze by mělo být zakázáno pro všechny databáze s výjimkou `master` , `msdb` a. `tempdb`          |Vysoká         |Řetězení vlastnictví mezi databázemi je rozšíření řetězení vlastnictví, s výjimkou hranice databáze. Toto pravidlo zkontroluje, zda je tato možnost zakázána pro všechny databáze s výjimkou `master` , `msdb` a `tempdb` . Pro `master` , `msdb` a `tempdb` je ve výchozím nastavení povolené řetězení vlastnictví mezi databázemi.        |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1043     |Host typu Principal by neměl mít přístup k žádné uživatelské databázi.          |Střední         |Uživatel typu Host umožňuje přístup k databázi pro všechna přihlášení, která nejsou namapovaná na konkrétního uživatele databáze. Toto pravidlo zkontroluje, zda se uživatel typu Host nemůže připojit k žádné databázi.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL        |
|VA1046     |Pro všechna přihlášení SQL by se měla povolit CHECK_POLICY.          |Nízká         |Možnost CHECK_POLICY umožňuje ověřování přihlašovacích údajů SQL na základě zásad domény. Toto pravidlo zkontroluje, zda je možnost CHECK_POLICY povolena pro všechna přihlášení SQL.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1047     |Pro všechna přihlášení SQL by měla být povolena kontrolu vypršení platnosti hesla.          |Nízká         |Zásady vypršení platnosti hesla se používají ke správě životnosti hesla. Pokud SQL Server vynutila zásady vypršení platnosti hesla, uživatelům se zobrazí výzva, aby změnila stará hesla a účty, jejichž hesla vypršela, jsou zakázané. Toto pravidlo kontroluje, jestli jsou pro všechna přihlášení SQL povolená zásada vypršení platnosti hesla.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1048     |Objekty zabezpečení databáze by neměly být namapovány na `sa` účet          |Vysoká         |Objekt zabezpečení databáze, který je namapovaný na `sa` účet, může útočník zneužít k zvýšení oprávnění na `sysadmin`         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1052     |Odebrat BUILTIN\Administrators jako přihlašovací jméno serveru          |Nízká         |Skupina BUILTIN\Administrators obsahuje místní skupinu Administrators systému Windows. Ve starších verzích Microsoft SQL Server má tato skupina ve výchozím nastavení práva správce. Toto pravidlo zkontroluje, zda je tato skupina odebrána z SQL Server.         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1053     |Účet s výchozím názvem `sa` by měl být přejmenován nebo zakázán.          |Nízká         |`sa` je dobře známý účet s ID objektu zabezpečení 1. Toto pravidlo ověří, že `sa` účet je buď přejmenován, nebo zakázán.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1054     |VEŘEJNÉ roli pro objekty nebo sloupce by nemělo být uděleno nadměrné oprávnění.          |Nízká         |Každé přihlášení SQL Server patří do role veřejného serveru. Pokud objekt zabezpečení serveru nemá udělené nebo zakázané konkrétní oprávnění pro zabezpečitelný objekt, uživatel zdědí oprávnění udělená veřejnému objektu. Toto pravidlo zobrazí seznam všech zabezpečených objektů nebo sloupců, které jsou přístupné všem uživatelům prostřednictvím veřejné role.         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1058     |`sa` přihlašovací jméno by mělo být zakázané.          |Vysoká         |`sa` je dobře známý účet s ID objektu zabezpečení 1. Toto pravidlo ověří, jestli `sa` je účet zakázaný.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1059     |xp_cmdshell by měl být zakázán          |Vysoká         |xp_cmdshell vytvoří příkazové prostředí systému Windows a předá ho řetězec ke spuštění. Toto pravidlo zkontroluje, zda je xp_cmdshell zakázán.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1067     |Pokud se Databázová pošta XPs nepoužívá, měla by být vypnutá.          |Střední         |Toto pravidlo zkontroluje, jestli je Databázová pošta zakázaná, když není nakonfigurovaný žádný profil databázového e-mailu. Databázová pošta lze použít pro posílání e-mailových zpráv z databázového stroje SQL Server a je ve výchozím nastavení zakázáno. Pokud tuto funkci nepoužíváte, doporučuje se ji zakázat, aby se snížila plocha.         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1068     |Oprávnění serveru by se neměla udělit přímo k objektům zabezpečení          |Nízká         |Oprávnění na úrovni serveru jsou přidružená k objektu na úrovni serveru, která určují, kteří uživatelé mohou získat přístup k objektu. Toto pravidlo kontroluje, zda neexistují žádná oprávnění na úrovni serveru udělená přímo pro přihlášení.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1070     |Uživatelé databáze by neměli sdílet stejný název jako přihlašovací jméno serveru.          |Nízká         |Uživatelé databáze můžou sdílet stejný název jako přihlašovací jméno serveru. Toto pravidlo ověřuje, že žádní tito uživatelé neexistují.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1072     |Režim ověřování by měl být ověřování systému Windows.          |Střední         |Existují dva možné režimy ověřování: režim ověřování systému Windows a smíšený režim. Smíšený režim znamená, že SQL Server umožňuje ověřování systému Windows i ověřování SQL Server. Toto pravidlo zkontroluje, zda je režim ověřování nastaven na ověřování systému Windows.         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1094     |Oprávnění databáze by se neměla udělit přímo k objektům zabezpečení          |Nízká         |Oprávnění jsou pravidla spojená s zabezpečitelným objektem, která určují, kteří uživatelé mohou získat přístup k objektu. Toto pravidlo kontroluje, zda nejsou k dispozici žádná oprávnění databáze udělená přímo uživatelům.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1095     |VEŘEJNÉ roli by se neměla udělit nadměrné oprávnění.          |Střední         |Každé přihlášení SQL Server patří do role veřejného serveru. Pokud objekt zabezpečení serveru nemá udělené nebo zakázané konkrétní oprávnění pro zabezpečitelný objekt, uživatel zdědí oprávnění udělená veřejnému objektu. Zobrazí se seznam všech oprávnění, která jsou udělena veřejné roli.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1096     |HOSTŮm typu Principal by se neměla udělit oprávnění v databázi.          |Nízká         |Každá databáze obsahuje uživatele s názvem host. Oprávnění udělená HOSTŮm se dědí uživatelům, kteří mají přístup k databázi, ale nemají v databázi uživatelský účet. Toto pravidlo zkontroluje, že všechna oprávnění byla odvolána od uživatele typu Host.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1097     |HOSTŮm typu Principal by se neměla udělit oprávnění k objektům nebo sloupcům.          |Nízká         |Každá databáze obsahuje uživatele s názvem host. Oprávnění udělená HOSTŮm se dědí uživatelům, kteří mají přístup k databázi, ale nemají v databázi uživatelský účet. Toto pravidlo zkontroluje, že všechna oprávnění byla odvolána od uživatele typu Host.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1099     |Uživateli typu Host by se neměla udělit oprávnění k zabezpečitelným databázím.          |Nízká         |Každá databáze obsahuje uživatele s názvem host. Oprávnění udělená HOSTŮm se dědí uživatelům, kteří mají přístup k databázi, ale nemají v databázi uživatelský účet. Toto pravidlo zkontroluje, že všechna oprávnění byla odvolána od uživatele typu Host.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1246     |Aplikační role by se neměly používat.          |Nízká         |Aplikační role je objekt zabezpečení databáze, který umožňuje, aby aplikace běžela s vlastními oprávněními jako uživatel. Aplikační role umožňují přístup k určitým datům pouze uživatelům, kteří se připojují prostřednictvím konkrétní aplikace. Aplikační role jsou založené na heslech (které aplikace většinou nekódujte pevně) a nejsou na základě oprávnění, které zveřejňují databázi pro zosobnění rolí aplikace pomocí odhadu hesla. Toto pravidlo zkontroluje, že v databázi nejsou definovány žádné aplikační role.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL<br/><br/>SQL Database         |
|VA1248     |Uživatelsky definované databázové role by neměly být členy pevných rolí.          |Střední         |Chcete-li snadno spravovat oprávnění ve vašich databázích SQL Server poskytuje několik rolí, což jsou objekty zabezpečení, které seskupují jiné objekty zabezpečení. Jsou to například skupiny v operačním systému Microsoft Windows. Účty databáze a další SQL Server role lze přidat do rolí na úrovni databáze. Každý člen role pevné databáze může do stejné role přidat další uživatele. Toto pravidlo zkontroluje, že žádné role definované uživatelem nejsou členy pevných rolí.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1267     |Uživatelé s omezením by měli používat ověřování systému Windows          |Střední         |Uživatelé s omezením jsou uživatelé, kteří existují v databázi a nevyžadují mapování přihlašovacích údajů. Toto pravidlo kontroluje, zda uživatelé používají ověřování systému Windows.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1280     |Oprávnění serveru udělená veřejnosti by se měla minimalizovat.          |Střední         |Každé přihlášení SQL Server patří do role veřejného serveru. Pokud objekt zabezpečení serveru nemá udělené nebo zakázané konkrétní oprávnění pro zabezpečitelný objekt, uživatel zdědí oprávnění udělená veřejnému objektu. Toto pravidlo zkontroluje, zda jsou minimalizována oprávnění serveru udělená veřejnosti.          |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1282     |Je potřeba odebrat osamocené role.          |Nízká         |Osamocené role jsou uživatelsky definované role, které nemají žádné členy. Eliminujte osamocené role, protože v systému nejsou potřeba. Toto pravidlo zkontroluje, zda existují žádné osamocené role.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2020     |Minimální sadě objektů zabezpečení by se měla udělit změna nebo změna všech oprávnění v oboru databáze uživatele.          |Vysoká         |Každý SQL Server, který je zabezpečený, má přidružená oprávnění, která je možné udělit objektům zabezpečení. Oprávnění můžou být vymezená na úrovni serveru (přiřazená k přihlašovacím jménům a rolím serveru) nebo na úrovni databáze (přiřazená uživatelům databáze a databázovým rolím). Tato pravidla kontrolují, že pouze minimální sada objektů zabezpečení je udělována změnám nebo mění jakákoli oprávnění vymezená databáze uživatele.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2033     |Minimální sadě objektů zabezpečení by mělo být pro objekty nebo sloupce uděleno oprávnění EXECUTE v oboru databáze.          |Nízká         |Toto pravidlo kontroluje, které objekty zabezpečení mají udělena oprávnění EXECUTE pro objekty nebo sloupce, aby bylo zajištěno, že toto oprávnění je uděleno minimální sadě objektů zabezpečení. Každý SQL Server, který je zabezpečený, má přidružená oprávnění, která je možné udělit objektům zabezpečení. Oprávnění můžou být vymezená na úrovni serveru (přiřazená k přihlašovacím jménům a rolím serveru) nebo na úrovni databáze (přiřazená uživatelům databáze, databázovým rolím nebo rolím aplikací). Oprávnění EXECUTE platí pro uložené procedury i pro skalární funkce, které lze použít v počítaných sloupcích.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2103     |Nepotřebná oprávnění EXECUTE pro rozšířené uložené procedury by měla být odvolána.          |Střední         |Rozšířené uložené procedury jsou knihovny DLL, které mohou být instance SQL Server dynamicky načteny a spuštěny. SQL Server je zabalen s mnoha rozšířenými uloženými procedurami, které umožňují interakci s knihovnami DLL systému. Toto pravidlo kontroluje, zda byla odvolána nepotřebná oprávnění EXECUTE pro rozšířené uložené procedury.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA2107     |Minimální sada objektů zabezpečení by měla být členy pevných rolí hlavní databáze služby Azure SQL DB.          |Vysoká         |SQL Database poskytuje v hlavní databázi dvě role pro správu s omezeným přístupem, ke kterým je možné přidat uživatelské účty, které udělují oprávnění k vytváření databází nebo správě přihlašování. Toto pravidlo kontroluje, zda je minimální sada objektů zabezpečení členem těchto rolí pro správu.         |<nobr/>SQL Database<br/><br/>Azure Synapse         |
|VA2108     |Minimální sada objektů zabezpečení by měla být členem pevné databázové role s vysokým dopadem.          |Vysoká         |SQL Server poskytuje role, které vám pomůžou se správou oprávnění. Role jsou objekty zabezpečení, které seskupují jiné objekty zabezpečení. Role na úrovni databáze jsou v oboru oprávnění v rámci databáze. Toto pravidlo zkontroluje, zda je minimální sada objektů zabezpečení členem pevných databázových rolí.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2109     |Minimální sada objektů zabezpečení by měla být členy pevných rolí databáze s nízkým dopadem.          |Nízká         |SQL Server poskytuje role, které vám pomůžou se správou oprávnění. Role jsou objekty zabezpečení, které seskupují jiné objekty zabezpečení. Role na úrovni databáze jsou v oboru oprávnění v rámci databáze. Toto pravidlo zkontroluje, zda je minimální sada objektů zabezpečení členem pevných databázových rolí.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2110     |Oprávnění EXECUTE pro přístup k registru by se měla odvolat.          |Vysoká         |Rozšířené uložené procedury registru umožňují Microsoft SQL Server čtení a vypisování hodnot a klíčů v registru. Je používá Enterprise Manager ke konfiguraci serveru. Toto pravidlo zkontroluje, že oprávnění ke spouštění rozšířených uložených procedur registru byla odvolána všemi uživateli (kromě dbo).         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA2113     |Oprávnění služby Data Transformation Services (DTS) by se měla udělit jenom rolím SSIS.          |Střední         |Služba Data Transformation Services (DTS) je sada objektů a nástrojů, které umožňují automatizaci operací extrakce, transformace a načítání do nebo z databáze. Objekty jsou balíčky DTS a jejich komponenty a nástroje se nazývají nástroje DTS. Toto pravidlo kontroluje, že oprávnění k použití uložených procedur systému DTS a oprávnění pro veřejnou roli pro použití uložených procedur systému DTS byla udělena pouze rolím SSIS.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA2114     |Minimální sada objektů zabezpečení by měla být členy pevných rolí serveru s vysokým dopadem.          |Vysoká         |SQL Server poskytuje role, které vám pomůžou se správou oprávnění. Role jsou objekty zabezpečení, které seskupují jiné objekty zabezpečení. Role na úrovni serveru jsou v oboru oprávnění v rámci serveru. Toto pravidlo zkontroluje, zda je minimální sada objektů zabezpečení členem pevných rolí serveru.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA2129     |Změny v podepsaných modulech by měly být autorizovány          |Vysoká         |Uloženou proceduru, funkci nebo Trigger můžete podepsat pomocí certifikátu nebo asymetrického klíče. To je určené pro scénáře, kdy oprávnění nejde dědit pomocí zřetězení vlastnictví nebo když je řetěz vlastnictví poškozený, jako je například dynamický SQL. Toto pravidlo kontroluje změny provedené v podepsaných modulech, což by mohlo být označením škodlivého použití.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Databáze SQL<br/><br/>Spravovaná instance SQL         |
|VA2130     |Sledovat všechny uživatele s přístupem k databázi          |Nízká         |Tato kontrolu sleduje všechny uživatele s přístupem k databázi. Ujistěte se, že tito uživatelé mají oprávnění podle aktuální role v organizaci.         |<nobr>SQL Database<nobr/><br/><br/>Azure Synapse         |

## <a name="auditing-and-logging"></a>Auditování a protokolování

|ID pravidla  |Název pravidla  |Závažnost pravidla  |Popis pravidla  |Platforma  |
|---------|---------|---------|---------|---------|
|VA1045     |Mělo by být povolené výchozí trasování.          |Střední         |Výchozí trasování zajišťuje pomoc při řešení potíží správcům databáze tím, že zajistí, že budou mít data protokolu potřebná k diagnostice problémů při prvním výskytu. Toto pravidlo zkontroluje, zda je povoleno výchozí trasování.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1091     |Auditování úspěšných a neúspěšných pokusů o přihlášení (výchozí trasování) by mělo být povoleno, pokud je nastaveno "auditování přihlášení" pro sledování přihlášení          |Nízká         |SQL Server konfigurace auditování přihlášení umožňuje správcům sledovat uživatele přihlašování k instancím SQL Server. Pokud se uživatel rozhodne počítat s možností auditování přihlášení, aby mohli sledovat uživatele přihlášené k instancím SQL Server, je důležité ho povolit pro úspěšné i neúspěšné pokusy o přihlášení.         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1093     |Maximální počet protokolů chyb by měl být 12 nebo více.          |Nízká         |Každý protokol chyb SQL Server bude mít všechny informace týkající se selhání/chyb, ke kterým došlo od posledního restartování SQL Server nebo od posledního vyrecyklace protokolů chyb. Toto pravidlo zkontroluje, zda je maximální počet protokolů chyb 12 nebo více.         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1258     |Vlastníci databáze jsou podle očekávání.          |Vysoká         |Vlastníci databáze mohou provádět všechny aktivity konfigurace a údržby databáze a také mohou vyřadit databáze v SQL Server. Sledování vlastníků databáze je důležité, aby nedocházelo k nadměrnému oprávnění pro některé objekty zabezpečení. Vytvořte směrný plán, který definuje očekávané vlastníky databáze pro databázi. Toto pravidlo zkontroluje, zda jsou vlastníci databáze definovány ve standardních hodnotách.         |<nobr>SQL Server 2016 +<sup>3</sup><nobr/><br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1264     |Mělo by se povolit auditování úspěšných i neúspěšných pokusů o přihlášení.          |Nízká         |SQL Server konfigurace auditování umožňuje správcům sledovat uživatele přihlášené k SQL Server instancím, za které zodpovídají. Toto pravidlo kontroluje, zda je povoleno auditování pro úspěšné i neúspěšné pokusy o přihlášení.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1265     |Mělo by se povolit auditování úspěšných i neúspěšných pokusů o přihlášení pro ověřování obsaženou v databázi.          |Střední         |SQL Server konfigurace auditování umožňuje správcům sledovat protokolování uživatelů do SQL Server instancí, za které zodpovídají. Toto pravidlo kontroluje, zda je povoleno auditování pro úspěšné i neúspěšné pokusy o přihlášení pro ověřování obsaženým DB.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1281     |Všechna členství pro uživatelsky definované role by měla být určena.          |Střední         |Uživatelsky definované role jsou objekty zabezpečení definované uživatelem, které seskupují objekty zabezpečení, aby mohli snadno spravovat oprávnění. Monitorování těchto rolí je důležité, aby nedocházelo k nadměrným oprávněním. Vytvořte směrný plán, který definuje očekávané členství pro každou uživatelsky definovanou roli. Toto pravidlo zkontroluje, zda jsou všechna členství pro uživatelsky definované role definovány ve standardních hodnotách.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1283     |V systému by měl být aspoň jeden aktivní audit.          |Nízká         |Auditování instance SQL Server databázového stroje nebo jednotlivé databáze zahrnuje sledování a protokolování událostí, ke kterým dochází v databázovém stroji. Objekt auditu SQL Server shromažďuje jednu instanci akcí na úrovni serveru nebo databáze a skupin akcí, které se mají monitorovat. Toto pravidlo zkontroluje, zda v systému existuje alespoň jeden aktivní audit.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA2061     |Auditování by mělo být povolené na úrovni serveru          |Vysoká         |Azure SQL Database auditování sleduje události databáze a zapisuje je do protokolu auditu ve vašem účtu služby Azure Storage. Auditování pomáhá pochopit databázovou činnost a získat přehled o nesouladuch a anomáliích, které by mohly označovat obavy z podnikání nebo podezření na narušení zabezpečení, a také vám pomůže splnit dodržování legislativních předpisů. Další informace najdete v tématu věnovaném [auditování Azure SQL](./auditing-overview.md). Toto pravidlo zkontroluje, zda je povoleno auditování.         |<nobr/>SQL Database<br/><br/>Azure Synapse          |

## <a name="data-protection"></a>Ochrana dat

|ID pravidla  |Název pravidla  |Závažnost pravidla  |Popis pravidla  |Platforma  |
|---------|---------|---------|---------|---------|
|VA1098     |Existující koncový bod SSB nebo zrcadlení by měl vyžadovat připojení AES.          |Vysoká         |Service Broker a zrcadlení koncových bodů podporují různé šifrovací algoritmy, včetně bez šifrování. Toto pravidlo kontroluje, zda jakýkoliv existující koncový bod vyžaduje šifrování AES.         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1219     |Mělo by být povolené transparentní šifrování dat.          |Střední         |Transparentní šifrování dat (TDE) pomáhá chránit soubory databáze před zpřístupněním informací pomocí šifrování a dešifrování databáze, přidružených záloh a souborů protokolů transakcí v klidovém provozu bez nutnosti změny aplikace. Toto pravidlo zkontroluje, že je v databázi povolená možnost TDE.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1220     |Komunikace s databází pomocí protokolu TDS by měla být chráněná pomocí protokolu TLS.          |Vysoká         |Microsoft SQL Server můžou používat SSL (Secure Sockets Layer) (SSL) nebo TLS (Transport Layer Security) k šifrování dat, která se přenášejí přes síť mezi instancí SQL Server a klientskou aplikací. Toto pravidlo zkontroluje, že všechna připojení k SQL Server jsou šifrována pomocí protokolu TLS.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1221     |Symetrický klíč šifrování databáze by měl používat algoritmus AES          |Vysoká         |SQL Server používá šifrovací klíče k zabezpečení přihlašovacích údajů a informací o připojení uložených v databázi serveru. SQL Server má dva druhy klíčů: symetrický a asymetrický. Toto pravidlo kontroluje, zda symetrické klíče šifrování databáze používají algoritmus AES.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1222     |Šifrovací klíče Cell-Level by měly používat algoritmus AES          |Vysoká         |Cell-Level šifrování (CLE) umožňuje šifrovat data pomocí symetrických a asymetrických klíčů. Toto pravidlo kontroluje, zda Cell-Level symetrických klíčů šifrování používá algoritmus AES.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1223     |Klíče certifikátu by měly používat minimálně 2048 bitů.          |Vysoká         |Klíče certifikátů se používají v RSA a dalších šifrovacích algoritmech k ochraně dat. Aby bylo možné zabezpečit data uživatele, musí být tyto klíče dostatečně dlouhé. Toto pravidlo kontroluje, zda je délka klíče minimálně 2048 bitů pro všechny certifikáty.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1224     |Délka asymetrických klíčů by měla být minimálně 2048 bitů.          |Vysoká         |Databázové asymetrické klíče se používají v mnoha šifrovacích algoritmech. Tyto klíče musí mít dostatečnou délku k zabezpečení šifrovaných dat. Toto pravidlo kontroluje, jestli všechny asymetrické klíče uložené v databázi mají minimálně 2048 bitů.         |<nobr>SQL Server 2012<nobr/><br/><br/><nobr>SQL Server 2014<nobr/><br/><br/>SQL Database         |
|VA1279     |Pro TDS by mělo být povolené šifrování.          |Vysoká         |Když je u databázového stroje povolená možnost Vynutit šifrování, zašifruje se veškerá komunikace mezi klientem a serverem bez ohledu na to, jestli je zaškrtnuté políčko šifrovat připojení (například z SSMS). Toto pravidlo zkontroluje, jestli je povolená možnost vynucení šifrování.         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1288     |Sloupce citlivých dat by měly být klasifikovány          |Střední         |Toto pravidlo zkontroluje, zda má naskenovaná databáze potenciálně citlivá data, která nebyla klasifikována.         |<nobr/>SQL Database         |
|VA2060     |Detekce hrozeb SQL by měla být povolená na úrovni serveru          |Střední         |Detekce hrozeb SQL poskytuje vrstvu zabezpečení, která detekuje potenciální ohrožení zabezpečení a neobvyklé aktivitu v databázích, jako jsou útoky prostřednictvím injektáže SQL a nezvyklé vzorce chování. Když je zjištěna potenciální hrozba detekce hrozeb, odešle e-mail a v Azure Security Center, který obsahuje jasný postup pro šetření a nápravu pro konkrétní hrozby. Další informace najdete v tématu [konfigurace detekce hrozeb](./threat-detection-configure.md). Tato kontrolu ověří, že je povolená detekce hrozeb SQL.         |<nobr/><br/>Spravovaná instance SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |

## <a name="installation-updates-and-patches"></a>Aktualizace a opravy instalace

|ID pravidla  |Název pravidla  |Závažnost pravidla  |Popis pravidla  |Platforma  |
|---------|---------|---------|---------|---------|
| VA1018     |Měly by být nainstalované nejnovější aktualizace.          |Vysoká         |Společnost Microsoft pravidelně vydává kumulativní aktualizace (kapacitní jednotky) pro každou verzi SQL Server. Toto pravidlo kontroluje, zda byl nainstalován poslední objekt CU pro konkrétní verzi SQL Server, předáním řetězce k provedení. Toto pravidlo zkontroluje, že všichni uživatelé (s výjimkou dbo) nemají oprávnění ke spuštění xp_cmdshell rozšířené uložené procedury. |<nobr>SQL Server 2005<nobr/><br/><br/><nobr>SQL Server 2008<nobr/><br/><br/><nobr>SQL Server 2008<nobr/><br/><br/><nobr>SQL Server 2012<nobr/><br/><br/><nobr>SQL Server 2014<nobr/><br/><br/><nobr>SQL Server 2016<nobr/><br/><br/>SQL Server 2017<br/>|
|VA2128     |Posouzení ohrožení zabezpečení není podporované pro SQL Server verze nižší než SQL Server 2012          |Vysoká         |Chcete-li spustit kontrolu posouzení ohrožení zabezpečení na SQL Server Server je nutné upgradovat na SQL Server 2012 nebo vyšší, SQL Server 2008 R2 a níže již nejsou podporovány společností Microsoft. Další informace najdete v tématu <https://www.microsoft.com/cloud-platform/windows-sql-server-2008>.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |

## <a name="surface-area-reduction"></a>Snížení oblasti povrchu

|ID pravidla  |Název pravidla  |Závažnost pravidla  |Popis pravidla  |Platforma  |
|---------|---------|---------|---------|---------|
|VA1022     |Ad hoc distribuované dotazy by se měly zakázat.          |Střední         |Ad hoc distribuované dotazy používají `OPENROWSET` funkce a `OPENDATASOURCE` pro připojení ke vzdáleným zdrojům dat, které používají OLE DB. Toto pravidlo kontroluje, zda jsou povoleny ad hoc distribuované dotazy.         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1023     |Modul CLR by měl být zakázán.          |Vysoká         |CLR umožňuje hostování spravovaného kódu a jeho spuštění v prostředí Microsoft SQL Server. Toto pravidlo zkontroluje, zda je modul CLR zakázán.         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1026     |Modul CLR by měl být zakázán.          |Střední         |CLR umožňuje hostování spravovaného kódu a jeho spuštění v prostředí Microsoft SQL Server. CLR strict security považuje bezpečná a EXTERNAL_ACCESS sestavení, jako kdyby byla označena jako nebezpečná a vyžaduje, aby všechna sestavení byla podepsána certifikátem nebo asymetrickým klíčem s odpovídajícím přihlašovacím jménem, kterému bylo uděleno nezabezpečené oprávnění sestavení v hlavní databázi. Toto pravidlo zkontroluje, zda je modul CLR zakázán.         |<nobr>SQL Server 2017 +<sup>2</sup><nobr/><br/><br/>Spravovaná instance SQL         |
|VA1027     |Nesledovaná důvěryhodná sestavení by měla být odebrána          |Vysoká         |Sestavení označená jako nebezpečná musí být podepsána certifikátem nebo asymetrickým klíčem s odpovídajícím přihlašovacím jménem, kterému bylo uděleno nezabezpečené oprávnění sestavení v hlavní databázi. Důvěryhodná sestavení mohou tento požadavek obejít.          |<nobr>SQL Server 2017 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1044     |Připojení vzdáleného správce by mělo být zakázáno, pokud není výslovně vyžadováno          |Střední         |Toto pravidlo kontroluje, zda jsou vzdálená vyhrazená připojení správce zakázána, pokud nejsou používána ke clusteringu pro omezení oblasti útoku. SQL Server poskytuje vyhrazené připojení správce (DAC). DAC umožňuje správcům přístup k běžícímu serveru, který spouští diagnostické funkce nebo příkazy jazyka Transact-SQL, nebo k řešení problémů na serveru a je to atraktivní cíl útoku, pokud je povolený vzdáleně.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1051     |AUTO_CLOSE by mělo být zakázáno pro všechny databáze          |Střední         |Možnost AUTO_CLOSE určuje, zda se databáze bez problémů vypne a uvolní prostředky po odpojení posledního uživatele. Bez ohledu na jeho výhody může způsobit odepření služby tím, že databázi významně otevírá a zavírá, proto je důležité tuto funkci zakázat. Toto pravidlo zkontroluje, zda je tato možnost v aktuální databázi zakázána.         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1066     |Nepoužívané koncové body služby Service Broker by se měly odebrat.          |Nízká         |Service Broker poskytuje zařazování do fronty a spolehlivé zasílání zpráv pro SQL Server. Service Broker se používá pro aplikace, které používají jednu instanci SQL Server a aplikace, které distribuují práci napříč více instancemi. Service Broker Koncové body poskytují možnosti pro zabezpečení přenosu a předávání zpráv. Toto pravidlo provede výčet všech koncových bodů služby Service Broker. Odeberte ty, které se nepoužívají.         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1071     |Možnost vyhledat spouštěcí uložené procedury by měla být zakázána.          |Střední         |Když je povolené "vyhledat spouštěcí procedury", SQL Server vyhledá a spustí všechny automaticky spuštěné uložené procedury definované na serveru. Pokud je tato možnost povolena SQL Server hledá a spustí všechny automaticky spuštěné uložené procedury, které jsou definovány na serveru. Toto pravidlo zkontroluje, zda je tato možnost zakázána.         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1092     |Služba SQL Server Browser by neměla inzerovat instanci SQL Server.          |Nízká         |SQL Server používá službu SQL Server Browser k vytvoření výčtu instancí databázového stroje nainstalovaného v počítači. To umožňuje klientským aplikacím Procházet server a pomáhá klientům rozlišovat mezi několika instancemi databázového stroje ve stejném počítači. Toto pravidlo zkontroluje, zda je instance SQL skrytá.         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1102     |Důvěryhodný bit by měl být zakázán na všech databázích s výjimkou MSDB          |Vysoká         |Vlastnost důvěryhodné databáze slouží k označení, zda instance SQL Server důvěřuje databázi a jejímu obsahu. Pokud je tato možnost povolena v databázových modulech (například uživatelsky definované funkce nebo uložené procedury), které používají kontext zosobnění, mají přístup k prostředkům mimo databázi. Toto pravidlo ověřuje, zda je důvěryhodný bit zakázán pro všechny databáze s výjimkou MSDB.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1143     |pro normální operaci služby by se neměl používat uživatel dbo.          |Střední         |Dbo nebo vlastník databáze je uživatelský účet, který má odvozená oprávnění k provádění všech aktivit v databázi. Členové pevné role serveru sysadmin jsou automaticky mapováni na dbo. Toto pravidlo zkontroluje, že dbo není jediným účtem, který má povolen přístup k této databázi. Všimněte si, že u nově vytvořené čisté databáze toto pravidlo selže, dokud se nevytvoří další role.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1144     |Databáze modelů by měla být přístupná pouze pomocí "dbo"          |Střední         |Modelová databáze se používá jako šablona pro všechny databáze vytvořené v instanci SQL Server. Změny provedené v modelové databázi, jako je model obnovení velikosti databáze a další možnosti databáze, se aplikují na všechny databáze vytvořené později. Toto pravidlo zkontroluje, jestli je jediným účtem, který má povolený přístup k databázi modelu, jenom dbo.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1230     |FileStream by měl být zakázán          |Vysoká         |FILESTREAM integruje databázový stroj SQL Server se systémem souborů NTFS tím, že ukládá data typu Binary (max) binární rozsáhlý objekt (BLOB) jako soubory v systému souborů. Příkazy jazyka Transact-SQL mohou vkládat, aktualizovat, dotazovat, Hledat a zálohovat data FILESTREAM. Povolení FILESTREAM na SQL serveru zveřejňuje dodatečné rozhraní API pro streamování souborů NTFS, které zvyšuje jeho plochu pro útok a umožňuje zneužití škodlivých útoků. Toto pravidlo zkontroluje, jestli je FILESTREAM zakázaný.         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1235     |Konfigurace serveru ' replikace XPs ' by měla být zakázána.          |Střední         |Pokud chcete omezit prostor pro útok, zakažte replikaci zastaralých konfigurací serveru na replikaci XPs. Toto je pouze interní nastavení konfigurace.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1244     |Osamocení uživatelé by měli být odebráni z databází systému SQL Server          |Střední         |Uživatel databáze, který existuje v databázi, ale nemá odpovídající přihlašovací údaje v hlavní databázi nebo jako externí prostředek (například uživatel systému Windows), se označuje jako osamocený uživatel a měl by být buď odebraný, nebo přemapovaný na platné přihlášení. Toto pravidlo kontroluje, zda neexistují žádní osamocení uživatelé.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1245     |Informace dbo by měly být konzistentní mezi cílovou databází a hlavní          |Vysoká         |Existují redundantní informace o identitě dbo pro všechny databáze: metadata uložená v samotné databázi a metadata uložená v hlavní databázi. Toto pravidlo kontroluje, zda jsou tyto informace konzistentní mezi cílovou databází a hlavním serverem.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1247     |Neměl by být označený jako automatický start pro SPs.          |Vysoká         |Pokud byla SQL Server nakonfigurovaná na ' vyhledat spouštěcí procedury ', server bude kontrolovat hlavní databázi pro uložené procedury označené jako automatické spuštění. Toto pravidlo kontroluje, zda není vybrána žádná aktualizace SPs jako automatické spuštění.         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1256     |Sestavení uživatelského rozhraní CLR by nemělo být definováno v databázi          |Vysoká         |Sestavení CLR lze použít k provedení libovolného kódu v procesu SQL Server. Toto pravidlo kontroluje, zda v databázi nejsou žádná uživatelsky definovaná sestavení CLR.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA1277     |Musí být povolené šifrování základní sítě.          |Vysoká         |Základem je technologie, která přistupuje k nerelačním i relačním datům ze služby SQL Server a kombinuje je. Možnost kódování základní sítě nakonfiguruje SQL Server k šifrování kanálů řízení a dat při použití základny. Toto pravidlo ověří, že je tato možnost povolená.         |<nobr>SQL Server 2016 +<nobr/>         |
|VA1278     |Vytvoření směrného plánu externích zprostředkovatelů správy klíčů          |Střední         |SQL Server Extensible Key Management (EKM) umožňuje dodavatelům modulů hardwarového zabezpečení (HSM) třetích stran registrovat své moduly v SQL Server. Pokud uživatelé zaregistrovaní SQL Server můžou používat šifrovací klíče uložené v modulech EKM, toto pravidlo zobrazí seznam zprostředkovatelů EKM používaných v systému.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA2062     |Pravidla brány firewall na úrovni databáze by neměla udělovat nadměrný přístup          |Vysoká         |Brána firewall na úrovni Azure SQL Database pomáhá chránit vaše data tím, že brání veškerému přístupu k vaší databázi, dokud neurčíte, které IP adresy mají oprávnění. Pravidla brány firewall na úrovni databáze udělují přístup ke konkrétní databázi na základě zdrojové IP adresy jednotlivých požadavků. Pravidla brány firewall na úrovni databáze pro hlavní a uživatelské databáze je možné vytvářet a spravovat pouze prostřednictvím jazyka Transact-SQL (na rozdíl od pravidel brány firewall na úrovni serveru, která lze také vytvořit a spravovat pomocí Azure Portal nebo PowerShellu). Další informace najdete v tématu [pravidla brány firewall pro Azure SQL Database a Azure synapse Analytics](./firewall-configure.md). Tato kontrolu ověřuje, zda pravidla brány firewall na úrovni databáze neudělují přístup k více než 255 IP adresám.         |<nobr/>SQL Database<br/><br/>Azure Synapse         |
|VA2063     |Pravidla brány firewall na úrovni serveru by neměla udělovat nadměrný přístup          |Vysoká         |Brána firewall na úrovni serveru Azure SQL pomáhá chránit váš server tím, že zabraňuje všem přístupům k vašim databázím, dokud neurčíte, které IP adresy mají oprávnění. Pravidla brány firewall na úrovni serveru udělují přístup ke všem databázím, které patří k serveru na základě zdrojové IP adresy jednotlivých požadavků.  Pravidla brány firewall na úrovni serveru se dají vytvářet a spravovat jenom pomocí jazyka Transact-SQL a také prostřednictvím Azure Portal nebo PowerShellu. Další informace najdete v tématu [pravidla brány firewall pro Azure SQL Database a Azure synapse Analytics](./firewall-configure.md). Tato kontrolu ověří, zda pravidla brány firewall na úrovni serveru neudělují přístup k více než 255 IP adresám.         |<nobr/>SQL Database<br/><br/>Azure Synapse         |
|VA2064     |Pravidla brány firewall na úrovni databáze by měla být sledována a udržována přísně minimálně          |Vysoká         |Brána firewall na úrovni Azure SQL Database pomáhá chránit vaše data tím, že brání veškerému přístupu k vaší databázi, dokud neurčíte, které IP adresy mají oprávnění. Pravidla brány firewall na úrovni databáze udělují přístup ke konkrétní databázi na základě zdrojové IP adresy jednotlivých požadavků. Pravidla brány firewall na úrovni databáze pro hlavní a uživatelské databáze je možné vytvářet a spravovat pouze prostřednictvím jazyka Transact-SQL (na rozdíl od pravidel brány firewall na úrovni serveru, která lze také vytvořit a spravovat pomocí Azure Portal nebo PowerShellu). Další informace najdete v tématu [pravidla brány firewall pro Azure SQL Database a Azure synapse Analytics](./firewall-configure.md). Tato funkce zkontroluje všechna pravidla brány firewall na úrovni databáze, aby bylo možné identifikovat a řešit všechny změny, které jsou v nich provedeny.         |<nobr/>SQL Database<br/><br/>Azure Synapse         |
|VA2065     |Pravidla brány firewall na úrovni serveru by měla být sledována a udržována striktním minimem          |Vysoká         |Brána firewall na úrovni serveru SQL Azure pomáhá chránit vaše data tím, že zabraňuje všem přístupům k vašim databázím, dokud neurčíte, které IP adresy mají oprávnění. Pravidla brány firewall na úrovni serveru udělují přístup ke všem databázím, které patří k serveru na základě zdrojové IP adresy jednotlivých požadavků.  Pravidla brány firewall na úrovni serveru se dají vytvářet a spravovat prostřednictvím jazyka Transact-SQL a také prostřednictvím Azure Portal nebo PowerShellu. Další informace najdete v tématu [pravidla brány firewall pro Azure SQL Database a Azure synapse Analytics](./firewall-configure.md).  Tato kontrolní část vytvoří výčet všech pravidel brány firewall na úrovni serveru, aby bylo možné identifikovat a řešit všechny změny, které jsou v nich provedeny.         |<nobr/>SQL Database<br/><br/>Azure Synapse         |
|VA2111     |Ukázkové databáze by se měly odebrat          |Nízká         |Microsoft SQL Server se dodává s několika ukázkovými databázemi. Toto pravidlo kontroluje, zda byly odebrány ukázkové databáze.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA2120     |Funkce, které mohou ovlivnit zabezpečení, by měly být zakázány.          |Vysoká         |SQL Server je schopný poskytovat široké spektrum funkcí a služeb. Některé funkce a služby, které jsou k dispozici ve výchozím nastavení, nemusí být nezbytné a jejich povolení by mohlo negativně ovlivnit zabezpečení systému. Toto pravidlo kontroluje, zda jsou tyto funkce zakázány.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA2121     | Funkce procedur automatizace OLE by měla být zakázaná.         |Vysoká         |SQL Server je schopný poskytovat široké spektrum funkcí a služeb. Některé funkce a služby, které jsou ve výchozím nastavení k dispozici, nemusí být nezbytné a jejich povolení by mohlo negativně ovlivnit zabezpečení systému. Možnost procedury automatizace technologie OLE určuje, zda lze vytvořit instanci objektů automatizace OLE v rámci balíků Transact-SQL. Jedná se o rozšířené uložené procedury, které umožňují SQL Server uživatelům spouštět funkce externě pro SQL Server. Bez ohledu na jeho výhody se dá použít i pro zneužití a je známý jako oblíbený mechanismus pro rostlinné soubory na cílových počítačích. Doporučuje se použít PowerShell jako náhradu pro tento nástroj. Toto pravidlo zkontroluje, zda je funkce procedury automatizace technologie OLE zakázána.          |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA2122     |Funkce uživatelských možností by měla být zakázaná.          |Střední         |SQL Server je schopný poskytovat široké spektrum funkcí a služeb. Některé funkce a služby, které jsou k dispozici ve výchozím nastavení, nemusí být nezbytné a jejich povolení by mohlo negativně ovlivnit zabezpečení systému. Možnosti uživatele určují globální výchozí hodnoty pro všechny uživatele. Seznam výchozích možností zpracování dotazu je stanoven po dobu trvání pracovní relace uživatele. Možnosti uživatele umožňují změnit výchozí hodnoty možností nastavení (Pokud výchozí nastavení serveru nejsou vhodná). Toto pravidlo zkontroluje, zda je funkce možnosti uživatele zakázána.         |<nobr>SQL Server 2012 +<nobr/><br/><br/>Spravovaná instance SQL         |
|VA2126     |Rozšiřitelnost – funkce, které mohou ovlivnit zabezpečení, by měly být zakázány, pokud není potřeba          |Střední         |SQL Server poskytuje široké spektrum funkcí a služeb. Některé funkce a služby, které jsou ve výchozím nastavení k dispozici, nemusí být nezbytné a jejich povolení by mohlo negativně ovlivnit zabezpečení systému. Toto pravidlo kontroluje, zda jsou zakázány konfigurace, které umožňují extrakci dat do externího zdroje dat a spouštění skriptů s určitou příponou jazyka.         |<nobr>SQL Server 2016 +<nobr/>         |

## <a name="removed-rules"></a>Odebraná pravidla

|ID pravidla  |Název pravidla  |
|---------|---------|
|VA1021     |Globální dočasné uložené procedury by měly být odebrány         |
|VA1024    |Měl by být povolen režim auditu C2. |
|VA1069     |Oprávnění pro výběr ze systémových tabulek a zobrazení by měla být odvolána od jiných než sysadmin.         |
|VA1090    |Zajistěte, aby všechny vlády GOTS (Policy) a vlastní uložené procedury byly šifrované. |
|VA1103    |Použít pouze CLR s oprávněním SAFE_ACCESS |
|VA1229     |Nastavení FILESTREAM v registru a v konfiguraci SQL Server se musí shodovat.         |
|VA1231     |FileStream by měl být zakázán (SQL)         |
|VA1234     |Mělo by se povolit nastavení společných kritérií.         |
|VA1252     |Seznam událostí, které jsou auditovány a centrálně spravovány prostřednictvím specifikací auditu serveru.         |
|VA1253     |Seznam auditovaných událostí v rámci databáze, které jsou auditovány a centrálně spravovány prostřednictvím specifikací pro audit serveru         |
|VA1263     |Vypíše všechny aktivní audity v systému.         |
|VA1266     |Možnost MUST_CHANGE je třeba nastavit pro všechna přihlášení SQL.         |
|VA1276     |Funkce agenta XPs by měla být zakázaná.         |
|VA1286     |Oprávnění databáze by se neměla udělit přímo k objektům zabezpečení (objekt nebo sloupec).         |
|VA2000     |Minimální sadě objektů zabezpečení by měla být udělena oprávnění s vysokým dopadem na databázi.         |
|VA2001     |Minimální sadě objektů zabezpečení by měla být pro objekty nebo sloupce udělena oprávnění s vysokým dopadem na databázi.         |
|VA2002     |Minimální sadě objektů zabezpečení by měla být pro různá zabezpečit udělena oprávnění s vysokým dopadem na databázi.         |
|VA2010     |Minimální sadě objektů zabezpečení by měla být udělena oprávnění s střednědobým dopadem na databázi.         |
|VA2021     |Minimální sadě objektů zabezpečení by měla být pro objekty nebo sloupce udělena oprávnění ALTER DATABASE s rozsahem.         |
|VA2022     |Minimální sadě objektů zabezpečení by se mělo udělit oprávnění ALTER DATABASE s rozsahem u různých zabezpečitelných.         |
|VA2030     |Minimální sadě objektů zabezpečení by se měla udělit oprávnění k výběru nebo spuštění v oboru databáze.         |
|VA2031     |U minimální sady objektů zabezpečení by měl být povolený výběr v rámci databáze.          |
|VA2032     |Minimální sadě objektů zabezpečení by měla být pro schéma udělena oprávnění SELECT nebo EXECUTE v rámci databáze.         |
|VA2034     |Minimální sadě objektů zabezpečení by mělo být uděleno oprávnění EXECUTE v rámci databáze v kolekci schémat XML.         |
|VA2040     |Minimální sadě objektů zabezpečení by měla být udělena oprávnění s nízkým dopadem na databázi.         |
|VA2041     |Minimální sadě objektů zabezpečení by měla být pro objekty nebo sloupce udělena oprávnění s nízkým dopadem na databázi.         |
|VA2042     |Minimální sadě objektů zabezpečení by měla být pro schéma udělena oprávnění s nízkým dopadem na databázi.         |
|VA2050     |Minimální sadě objektů zabezpečení by měla být udělena oprávnění definice zobrazení v oboru databáze.         |
|VA2051     |Minimální sadě objektů zabezpečení by měla být udělena oprávnění definice zobrazení v oboru databáze pro objekty nebo sloupce.         |
|VA2052     |Minimální sadě objektů zabezpečení by měla být udělena oprávnění definice zobrazení v rámci databáze u různých zabezpečitelných.         |
|VA2100     |Minimální sadě objektů zabezpečení by mělo být uděleno oprávnění s vysokým dopadem na server.         |
|VA2101     |Minimální sadě objektů zabezpečení by se měla udělit středně příznivý vliv na servery s rozsahem oprávnění.         |
|VA2102     |Minimální sadě objektů zabezpečení by měla být udělena oprávnění s nízkým dopadem na server.         |
|VA2104     |Oprávnění EXECUTE pro rozšířené uložené procedury by měla být odvolána z veřejného.         |
|VA2105     |Heslo pro přihlášení by se nemělo snadno odhadnout.         |
|VA2112     |Oprávnění veřejné služby pro službu Data Transformation Services (DTS) by měla být odvolána.         |
|VA2115     |Minimální sada objektů zabezpečení by měla být členem pevných rolí serveru střední dopad         |
|VA2123     |Funkce vzdálený přístup by měla být vypnutá.         |
|VA2127     |Funkce externích skriptů by měla být zakázaná.         |

## <a name="next-steps"></a>Další kroky

- [Posouzení ohrožení zabezpečení](sql-vulnerability-assessment.md)
- [Pravidla posouzení chyb zabezpečení SQL protokol změn](sql-database-vulnerability-assessment-rules-changelog.md)
